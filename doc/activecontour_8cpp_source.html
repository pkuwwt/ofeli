<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Ofeli: src ofeli/activecontour.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="Ofeli.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Ofeli
   &#160;<span id="projectnumber">1.0.4</span>
   </div>
   <div id="projectbrief">an Open, Fast and Efficient Level Set Implementation</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">src ofeli/activecontour.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">**</span>
<a name="l00003"></a>00003 <span class="comment">** Copyright (C) 2010-2011 Fabien Bessy.</span>
<a name="l00004"></a>00004 <span class="comment">** All rights reserved.</span>
<a name="l00005"></a>00005 <span class="comment">** Contact: fabien.bessy@gmail.com</span>
<a name="l00006"></a>00006 <span class="comment">**</span>
<a name="l00007"></a>00007 <span class="comment">** This file is part of Ofeli.</span>
<a name="l00008"></a>00008 <span class="comment">**</span>
<a name="l00009"></a>00009 <span class="comment">** You may use this file under the terms of the CeCILL license version 2 as follows:</span>
<a name="l00010"></a>00010 <span class="comment">**</span>
<a name="l00011"></a>00011 <span class="comment">** &quot;Redistribution and use in source and binary forms, with or without</span>
<a name="l00012"></a>00012 <span class="comment">** modification, are permitted provided that the following conditions are</span>
<a name="l00013"></a>00013 <span class="comment">** met:</span>
<a name="l00014"></a>00014 <span class="comment">**   * Redistributions of source code must retain the above copyright</span>
<a name="l00015"></a>00015 <span class="comment">**     notice, this list of conditions and the following disclaimer.</span>
<a name="l00016"></a>00016 <span class="comment">**   * Redistributions in binary form must reproduce the above copyright</span>
<a name="l00017"></a>00017 <span class="comment">**     notice, this list of conditions and the following disclaimer in</span>
<a name="l00018"></a>00018 <span class="comment">**     the documentation and/or other materials provided with the</span>
<a name="l00019"></a>00019 <span class="comment">**     distribution.</span>
<a name="l00020"></a>00020 <span class="comment">**   * Neither the name of Fabien Bessy nor the names of its contributors</span>
<a name="l00021"></a>00021 <span class="comment">**     may be used to endorse or promote products derived from this</span>
<a name="l00022"></a>00022 <span class="comment">**     software without specific prior written permission.</span>
<a name="l00023"></a>00023 <span class="comment">**</span>
<a name="l00024"></a>00024 <span class="comment">** THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="l00025"></a>00025 <span class="comment">** &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="l00026"></a>00026 <span class="comment">** LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00027"></a>00027 <span class="comment">** A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<a name="l00028"></a>00028 <span class="comment">** OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<a name="l00029"></a>00029 <span class="comment">** SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<a name="l00030"></a>00030 <span class="comment">** LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00031"></a>00031 <span class="comment">** DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00032"></a>00032 <span class="comment">** THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00033"></a>00033 <span class="comment">** (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00034"></a>00034 <span class="comment">** OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.&quot;</span>
<a name="l00035"></a>00035 <span class="comment">**</span>
<a name="l00036"></a>00036 <span class="comment">**                    For all legal intents and purposes.</span>
<a name="l00037"></a>00037 <span class="comment">**</span>
<a name="l00038"></a>00038 <span class="comment">****************************************************************************/</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;activecontour.hpp&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;cstring&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="keyword">namespace </span>ofeli {
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="classofeli_1_1_active_contour.html#a0d386b50e6363f739a6d39b23fae5197">00047</a> <a class="code" href="classofeli_1_1_active_contour.html#a0d386b50e6363f739a6d39b23fae5197" title="Constructor to initialize the active contour from geometrical parameters of an unique shape...">ActiveContour::ActiveContour</a>(<span class="keywordtype">int</span> width1, <span class="keywordtype">int</span> height1, <span class="keywordtype">bool</span> hasEllipse1, <span class="keywordtype">double</span> init_width1, <span class="keywordtype">double</span> init_height1, <span class="keywordtype">double</span> center_x1, <span class="keywordtype">double</span> center_y1, <span class="keywordtype">bool</span> hasSmoothingCycle1, <span class="keywordtype">int</span> kernel_length1, <span class="keywordtype">double</span> sigma1, <span class="keywordtype">bool</span> hasCleaning1, <span class="keywordtype">int</span> Na1, <span class="keywordtype">int</span> Ns1) : width(width1), height(height1), hasSmoothingCycle(hasSmoothingCycle1), kernel_length(kernel_length1), sigma(sigma1), hasCleaning(hasCleaning1), Na_max(Na1), Ns_max(Ns1), size(width1*height1), kernel_radius((kernel_length1-1)/2), phi(new char[width1*height1]), gaussian_kernel(make_gaussian_kernel(kernel_length1, sigma1)), max_iterations(calculate_max_iterations(width1, height1)) {
<a name="l00048"></a>00048 
<a name="l00049"></a>00049     <span class="keywordtype">int</span> x, y; <span class="comment">// position of the current pixel</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051     <span class="comment">// do an ellipse</span>
<a name="l00052"></a>00052     <span class="keywordflow">if</span>( hasEllipse1 ) {
<a name="l00053"></a>00053 
<a name="l00054"></a>00054         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classofeli_1_1_active_contour.html#a54751d6c94d075b3c6fafb93d84ae479" title="Image size, i.e. number of pixels. Obviously, it egals to width × height.">size</a>; i++ ) {
<a name="l00055"></a>00055 
<a name="l00056"></a>00056             <span class="comment">// i = x+y*width so</span>
<a name="l00057"></a>00057             y = i/<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00058"></a>00058             x = i-y*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00059"></a>00059 
<a name="l00060"></a>00060             <span class="comment">// ellipse inequation</span>
<a name="l00061"></a>00061             <span class="keywordflow">if</span> ((<span class="keywordtype">double</span>(y)-(1.0+2.0*center_y1)*<span class="keywordtype">double</span>(<a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>)/2.0)*(<span class="keywordtype">double</span>(y)-(1.0+2.0*center_y1)*<span class="keywordtype">double</span>(<a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>)/2.0)/(init_height1*<span class="keywordtype">double</span>(<a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>)/2.0*init_height1*<span class="keywordtype">double</span>(<a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>)/2.0)+(<span class="keywordtype">double</span>(x)-(1.0+2.0*center_x1)*<span class="keywordtype">double</span>(width)/2.0)*(<span class="keywordtype">double</span>(x)-(1.0+2.0*center_x1)*<span class="keywordtype">double</span>(width)/2.0)/(init_width1*<span class="keywordtype">double</span>(width)/2.0*init_width1*<span class="keywordtype">double</span>(width)/2.0) &gt; 1.0) {
<a name="l00062"></a>00062                 <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[i] = 1; <span class="comment">// outside</span>
<a name="l00063"></a>00063             }
<a name="l00064"></a>00064             <span class="keywordflow">else</span> {
<a name="l00065"></a>00065                 <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[i] = -1; <span class="comment">// inside</span>
<a name="l00066"></a>00066             }
<a name="l00067"></a>00067         }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069     }
<a name="l00070"></a>00070 
<a name="l00071"></a>00071     <span class="comment">// do a rectangle</span>
<a name="l00072"></a>00072     <span class="keywordflow">else</span> {
<a name="l00073"></a>00073 
<a name="l00074"></a>00074         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classofeli_1_1_active_contour.html#a54751d6c94d075b3c6fafb93d84ae479" title="Image size, i.e. number of pixels. Obviously, it egals to width × height.">size</a>; i++ ) {
<a name="l00075"></a>00075 
<a name="l00076"></a>00076             <span class="comment">// i = x+y*width so</span>
<a name="l00077"></a>00077             y = i/<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00078"></a>00078             x = i-y*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080             <span class="keywordflow">if</span>( <span class="keywordtype">double</span>(y) &gt; ((1.0-init_height1)*<span class="keywordtype">double</span>(<a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>)/2.0 + center_y1*<span class="keywordtype">double</span>(<a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>)) &amp;&amp; <span class="keywordtype">double</span>(y) &lt; ((<span class="keywordtype">double</span>(<a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>)-(1.0-init_height1)*<span class="keywordtype">double</span>(<a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>)/2.0) + center_y1*<span class="keywordtype">double</span>(<a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>)) &amp;&amp; <span class="keywordtype">double</span>(x) &gt; ((1.0-init_width1)*<span class="keywordtype">double</span>(width)/2.0 + center_x1*<span class="keywordtype">double</span>(width)) &amp;&amp; <span class="keywordtype">double</span>(x) &lt; ((<span class="keywordtype">double</span>(width)-(1.0-init_width1)*<span class="keywordtype">double</span>(width)/2.0) + center_x1*<span class="keywordtype">double</span>(width)) ) {
<a name="l00081"></a>00081                 <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[i] = -1; <span class="comment">// inside</span>
<a name="l00082"></a>00082             }
<a name="l00083"></a>00083             <span class="keywordflow">else</span> {
<a name="l00084"></a>00084                 <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[i] = 1; <span class="comment">// outside</span>
<a name="l00085"></a>00085             }
<a name="l00086"></a>00086         }
<a name="l00087"></a>00087 
<a name="l00088"></a>00088     }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090     <a class="code" href="classofeli_1_1_active_contour.html#a352ab5b5b6b389e9a55afa1db318dfda" title="Initialization of variables in the both constructors.">initialize</a>();
<a name="l00091"></a>00091 
<a name="l00092"></a>00092     <a class="code" href="classofeli_1_1_active_contour.html#a2fbcb81cc03239dae86e7a235dd64e00" title="To eliminate redundant points in Lin.">eliminate_redundant_in_Lin</a>(); <span class="comment">// clean Lin boundary</span>
<a name="l00093"></a>00093     <a class="code" href="classofeli_1_1_active_contour.html#a33de623e3a4aefe9f31b6ec28428f807" title="To eliminate redundant points in Lout.">eliminate_redundant_in_Lout</a>(); <span class="comment">// clean Lout boundary</span>
<a name="l00094"></a>00094 }
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="classofeli_1_1_active_contour.html#aa26156e467470d5f541410e55bb58770">00096</a> <a class="code" href="classofeli_1_1_active_contour.html#a0d386b50e6363f739a6d39b23fae5197" title="Constructor to initialize the active contour from geometrical parameters of an unique shape...">ActiveContour::ActiveContour</a>(<span class="keywordtype">int</span> width1, <span class="keywordtype">int</span> height1, <span class="keyword">const</span> <span class="keywordtype">char</span>* phi_init1, <span class="keywordtype">bool</span> hasSmoothingCycle1, <span class="keywordtype">int</span> kernel_length1, <span class="keywordtype">double</span> sigma1, <span class="keywordtype">bool</span> hasCleaning1, <span class="keywordtype">int</span> Na1, <span class="keywordtype">int</span> Ns1) : width(width1), height(height1), hasSmoothingCycle(hasSmoothingCycle1), kernel_length(kernel_length1), sigma(sigma1), hasCleaning(hasCleaning1), Na_max(Na1), Ns_max(Ns1), size(width1*height1), kernel_radius((kernel_length1-1)/2), phi(new char[width1*height1]), gaussian_kernel(make_gaussian_kernel(kernel_length1, sigma1)), max_iterations(calculate_max_iterations(width1, height1)) {
<a name="l00097"></a>00097 
<a name="l00098"></a>00098     <span class="keywordflow">if</span>( phi_init1 == NULL ) {
<a name="l00099"></a>00099         std::cerr &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;The pointer phi_init1 must be a non-null pointer, it must be allocated.&quot;</span> &lt;&lt; std::endl;
<a name="l00100"></a>00100     }
<a name="l00101"></a>00101     <span class="keywordflow">else</span> {
<a name="l00102"></a>00102         memcpy(<a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>,phi_init1,<a class="code" href="classofeli_1_1_active_contour.html#a54751d6c94d075b3c6fafb93d84ae479" title="Image size, i.e. number of pixels. Obviously, it egals to width × height.">size</a>); <span class="comment">// the buffer phi_init1 is const</span>
<a name="l00103"></a>00103         <a class="code" href="classofeli_1_1_active_contour.html#a352ab5b5b6b389e9a55afa1db318dfda" title="Initialization of variables in the both constructors.">initialize</a>();
<a name="l00104"></a>00104     }
<a name="l00105"></a>00105 }
<a name="l00106"></a>00106 
<a name="l00107"></a><a class="code" href="classofeli_1_1_active_contour.html#a352ab5b5b6b389e9a55afa1db318dfda">00107</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a352ab5b5b6b389e9a55afa1db318dfda" title="Initialization of variables in the both constructors.">ActiveContour::initialize</a>() {
<a name="l00108"></a>00108 
<a name="l00109"></a>00109     <span class="comment">// create initial Lin and Lout from phi</span>
<a name="l00110"></a>00110     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classofeli_1_1_active_contour.html#a54751d6c94d075b3c6fafb93d84ae479" title="Image size, i.e. number of pixels. Obviously, it egals to width × height.">size</a>; i++ ) {
<a name="l00111"></a>00111         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[i] == -1 ) {
<a name="l00112"></a>00112             <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>.push_front(i);
<a name="l00113"></a>00113         }
<a name="l00114"></a>00114         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[i] == 1 ) {
<a name="l00115"></a>00115             <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>.push_front(i);
<a name="l00116"></a>00116         }
<a name="l00117"></a>00117     }
<a name="l00118"></a>00118 
<a name="l00119"></a>00119     <span class="comment">// initialization of 4 variables for the oscillation stopping condition</span>
<a name="l00120"></a>00120     <a class="code" href="classofeli_1_1_active_contour.html#a653c2bcd37ed61e9eacda89a013590d4" title="Length of Lin + length of Lout of the previous iteration.">previous_lists_length</a> = 999999;
<a name="l00121"></a>00121     <a class="code" href="classofeli_1_1_active_contour.html#aefe0738d8a43f3981d591a0cc78ed717" title="Length of Lin + length of Lout.">lists_length</a> = 0;
<a name="l00122"></a>00122     <a class="code" href="classofeli_1_1_active_contour.html#a2ed4a3e2aa6904c287412a1510318b96" title="To count the number of times the relative gap of the lists length are less of a constant, fixed at 0.5%.">counter</a> = 0;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     <a class="code" href="classofeli_1_1_active_contour.html#a8464ac191aec1487b186a3f66b87b000" title="General initialization used for video tracking.">do_general_initialization_for_each_frame</a>();
<a name="l00125"></a>00125 
<a name="l00126"></a>00126     <span class="keywordflow">return</span>;
<a name="l00127"></a>00127 }
<a name="l00128"></a>00128 
<a name="l00129"></a><a class="code" href="classofeli_1_1_active_contour.html#a8464ac191aec1487b186a3f66b87b000">00129</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a8464ac191aec1487b186a3f66b87b000" title="General initialization used for video tracking.">ActiveContour::do_general_initialization_for_each_frame</a>() {
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a> = 0; <span class="comment">// in the cycle 1</span>
<a name="l00132"></a>00132     <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a> = 0; <span class="comment">// in the cycle 2</span>
<a name="l00133"></a>00133     <a class="code" href="classofeli_1_1_active_contour.html#a56384ad665bfd16485040e33b584eb64" title="Number of iterations in the last cycle 2.">Ns_last</a> = 0; <span class="comment">// in the last cycle 2</span>
<a name="l00134"></a>00134     <a class="code" href="classofeli_1_1_active_contour.html#a2ff3ef2151ddf1e7f9f260ad9bf3d6f2" title="Boolean egals to false to go away the cycle 1 and never to go back into.">hasCycle1</a> = <span class="keyword">true</span>;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136     <span class="comment">// 3 variables of 3 stopping conditions</span>
<a name="l00137"></a>00137     <a class="code" href="classofeli_1_1_active_contour.html#acaaac3e08e34cf03c1320c220b188b78" title="Boolean egals to true if hasOutwardEvolution egals to true or hasInwardEvolution egals to true...">hasListsChanges</a> = <span class="keyword">true</span>;
<a name="l00138"></a>00138     <a class="code" href="classofeli_1_1_active_contour.html#a23e817e4d98cdc2ba8da0b44c5d0ffb8" title="Boolean egals to true if oscillations are detected. In this case, hasAlgoStopping egals to true...">hasOscillation</a> = <span class="keyword">false</span>;
<a name="l00139"></a>00139     <a class="code" href="classofeli_1_1_active_contour.html#ac155630f750a4811ddbcb5c3b0aff2df" title="Number of times the active contour evolves.">iterations</a> = 0;
<a name="l00140"></a>00140 
<a name="l00141"></a>00141     <a class="code" href="classofeli_1_1_active_contour.html#ac239b94976782c0769bda5d2b1e3d1b8" title="Boolean egals to true to stop the algorithm.">hasAlgoStopping</a> = <span class="keyword">false</span>; <span class="comment">// to start the algorithm</span>
<a name="l00142"></a>00142 
<a name="l00143"></a>00143     <span class="keywordflow">return</span>;
<a name="l00144"></a>00144 }
<a name="l00145"></a>00145 
<a name="l00146"></a><a class="code" href="classofeli_1_1_active_contour.html#ac1d127818cc396568532a662951f6f8e">00146</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#ac1d127818cc396568532a662951f6f8e" title="Initialization for each new frame buffer, used for video tracking.">ActiveContour::initialize_for_each_frame</a>() {
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     <a class="code" href="classofeli_1_1_active_contour.html#a8464ac191aec1487b186a3f66b87b000" title="General initialization used for video tracking.">do_general_initialization_for_each_frame</a>();
<a name="l00149"></a>00149 
<a name="l00150"></a>00150     <span class="keywordflow">return</span>;
<a name="l00151"></a>00151 }
<a name="l00152"></a>00152 
<a name="l00153"></a><a class="code" href="classofeli_1_1_active_contour.html#a6c5e80a286279409a40f279f5e9f848c">00153</a> <span class="keyword">const</span> <span class="keywordtype">int</span>* <span class="keyword">const</span> <a class="code" href="classofeli_1_1_active_contour.html#a6c5e80a286279409a40f279f5e9f848c" title="To do a normalised gaussian kernel without to divide by π ">ActiveContour::make_gaussian_kernel</a>(<span class="keywordtype">int</span> kernel_length1, <span class="keywordtype">double</span> sigma1) {
<a name="l00154"></a>00154 
<a name="l00155"></a>00155     <span class="comment">// kernel_length impair and strictly positive</span>
<a name="l00156"></a>00156     <span class="keywordflow">if</span>( kernel_length1 % 2 == 0 ) {
<a name="l00157"></a>00157         kernel_length1--;
<a name="l00158"></a>00158     }
<a name="l00159"></a>00159     <span class="keywordflow">if</span>( kernel_length1 &lt; 1 ) {
<a name="l00160"></a>00160         kernel_length1 = 1;
<a name="l00161"></a>00161     }
<a name="l00162"></a>00162     <span class="comment">// protection against /0</span>
<a name="l00163"></a>00163     <span class="keywordflow">if</span>( sigma1 &lt; 0.000000001 ) {
<a name="l00164"></a>00164         sigma1 = 0.000000001;
<a name="l00165"></a>00165     }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167     <span class="keywordtype">int</span> x, y; <span class="comment">// position of the current pixel</span>
<a name="l00168"></a>00168 
<a name="l00169"></a>00169     <span class="keyword">const</span> <span class="keywordtype">int</span> kernel_size1 = kernel_length1*kernel_length1;
<a name="l00170"></a>00170     <span class="keyword">const</span> <span class="keywordtype">int</span> kernel_radius1 = (kernel_length1-1)/2;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172     <span class="keywordtype">int</span>* <span class="keyword">const</span> gaussian_kernel1 = <span class="keyword">new</span> <span class="keywordtype">int</span>[kernel_size1];
<a name="l00173"></a>00173 
<a name="l00174"></a>00174     <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; kernel_size1; i++ ) {
<a name="l00175"></a>00175 
<a name="l00176"></a>00176         <span class="comment">// i = x+y*kernel_length so</span>
<a name="l00177"></a>00177         y = i/kernel_length1;
<a name="l00178"></a>00178         x = i-y*kernel_length1;
<a name="l00179"></a>00179 
<a name="l00180"></a>00180         gaussian_kernel1[i] = int(100000.0*(exp( - ((<span class="keywordtype">double</span>(y)-<span class="keywordtype">double</span>(kernel_radius1))*(<span class="keywordtype">double</span>(y)-<span class="keywordtype">double</span>(kernel_radius1))+(<span class="keywordtype">double</span>(x)-<span class="keywordtype">double</span>(kernel_radius1))*(<span class="keywordtype">double</span>(x)-<span class="keywordtype">double</span>(kernel_radius1))) / (2*sigma1*sigma1))));
<a name="l00181"></a>00181 
<a name="l00182"></a>00182     }
<a name="l00183"></a>00183 
<a name="l00184"></a>00184     <span class="keywordflow">return</span> gaussian_kernel1;
<a name="l00185"></a>00185 }
<a name="l00186"></a>00186 
<a name="l00187"></a><a class="code" href="classofeli_1_1_active_contour.html#af1af6dc1037dda5738dc9964a9476b84">00187</a> <a class="code" href="classofeli_1_1_active_contour.html#af1af6dc1037dda5738dc9964a9476b84" title="Destructor to delete phi and gaussian_kernel.">ActiveContour::~ActiveContour</a>() {
<a name="l00188"></a>00188     <span class="keyword">delete</span>[] <a class="code" href="classofeli_1_1_active_contour.html#a0f8558877cf436d932838173ba5b8061" title="Pointer on the gaussian kernel buffer used to calculate Fint.">gaussian_kernel</a>;
<a name="l00189"></a>00189     <span class="keyword">delete</span>[] <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>;
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="classofeli_1_1_active_contour.html#a2ab521c583572158549d416ccc755f3a">00192</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a2ab521c583572158549d416ccc755f3a" title="Function called by evolve_one_iteration() for external or data dependant evolution with Fd speed...">ActiveContour::do_one_iteration_in_cycle1</a>() {
<a name="l00193"></a>00193 
<a name="l00194"></a>00194     <span class="keywordtype">int</span> i; <span class="comment">// offset of the current pixel for the image data buffer or phi</span>
<a name="l00195"></a>00195 
<a name="l00196"></a>00196     <span class="keywordtype">int</span> x, y; <span class="comment">// position of the current pixel</span>
<a name="l00197"></a>00197 
<a name="l00198"></a>00198     <a class="code" href="classofeli_1_1_active_contour.html#a9dcea2f4d6803007fe98e38152adf000" title="Boolean egals to true if one point of Lout at least is switched in during the scan throw the Lout lis...">hasOutwardEvolution</a> = <span class="keyword">false</span>;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <a class="code" href="classofeli_1_1_active_contour.html#ad81d408bec3feae072028c7db664797d" title="Specific step reimplemented in the children active contours ACwithoutEdges and ACwithoutEdgesYUV to c...">do_specific_beginning_step</a>(); <span class="comment">// to calculate Cout and Cin means in O(1)</span>
<a name="l00201"></a>00201 
<a name="l00202"></a>00202     <span class="comment">// scan throw Lout</span>
<a name="l00203"></a>00203     <span class="keywordflow">for</span>( <a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a> = <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>.begin(); <a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a> != <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>.end();  ) {
<a name="l00204"></a>00204 
<a name="l00205"></a>00205         i = *<a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a>;
<a name="l00206"></a>00206 
<a name="l00207"></a>00207         <span class="comment">// i = x+y*width so</span>
<a name="l00208"></a>00208         y = i/<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00209"></a>00209         x = i-y*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00210"></a>00210 
<a name="l00211"></a>00211         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#ab53eb16e33ba58b3bb9402a186d71d31" title="To compute the external speed Fd for a current point (x,y) of Lout or Lin.">compute_external_speed_Fd</a>(i,x,y) &gt; 0 ) {
<a name="l00212"></a>00212 
<a name="l00213"></a>00213             <a class="code" href="classofeli_1_1_active_contour.html#ae34d798fec18971f9b0f6cbed59c090f" title="Specific step reimplemented in the children active contours ACwithoutEdges and ACwithoutEdgesYUV to u...">do_specific_in_step</a>(i,x,y); <span class="comment">// updates of the variables to calculate the means Cout and Cin</span>
<a name="l00214"></a>00214 
<a name="l00215"></a>00215             <a class="code" href="classofeli_1_1_active_contour.html#ae503203f7eed34136805ea11175dcc62" title="Outward local movement of the curve for a current point (x,y) of Lout that is switched in Lin...">switch_in</a>(i,x,y); <span class="comment">// outward local movement</span>
<a name="l00216"></a>00216 
<a name="l00217"></a>00217             <span class="keywordflow">if</span>( !<a class="code" href="classofeli_1_1_active_contour.html#a9dcea2f4d6803007fe98e38152adf000" title="Boolean egals to true if one point of Lout at least is switched in during the scan throw the Lout lis...">hasOutwardEvolution</a> ) {
<a name="l00218"></a>00218                 <a class="code" href="classofeli_1_1_active_contour.html#a9dcea2f4d6803007fe98e38152adf000" title="Boolean egals to true if one point of Lout at least is switched in during the scan throw the Lout lis...">hasOutwardEvolution</a> = <span class="keyword">true</span>;
<a name="l00219"></a>00219             }
<a name="l00220"></a>00220 
<a name="l00221"></a>00221         }
<a name="l00222"></a>00222         <span class="keywordflow">else</span> {
<a name="l00223"></a>00223             ++<a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a>;
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     }
<a name="l00227"></a>00227 
<a name="l00228"></a>00228     <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a9dcea2f4d6803007fe98e38152adf000" title="Boolean egals to true if one point of Lout at least is switched in during the scan throw the Lout lis...">hasOutwardEvolution</a> &amp;&amp; <a class="code" href="classofeli_1_1_active_contour.html#a8d7a7c8b12556672bb052a84ae7f9671" title="Boolean egals to true to eliminate the redundant points in Lin and Lout lists.">hasCleaning</a> ) {
<a name="l00229"></a>00229         <a class="code" href="classofeli_1_1_active_contour.html#a2fbcb81cc03239dae86e7a235dd64e00" title="To eliminate redundant points in Lin.">eliminate_redundant_in_Lin</a>(); <span class="comment">// Lin boundary cleaning</span>
<a name="l00230"></a>00230     }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     <a class="code" href="classofeli_1_1_active_contour.html#af437460aa2cdf312166a3fe4d54beeb4" title="Boolean egals to true if one point of Lin at least is switched out during the scan throw the Lin list...">hasInwardEvolution</a> = <span class="keyword">false</span>;
<a name="l00233"></a>00233 
<a name="l00234"></a>00234     <span class="comment">// scan through Lin</span>
<a name="l00235"></a>00235     <span class="keywordflow">for</span>( <a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a> = <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>.begin(); <a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a> != <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>.end();  ) {
<a name="l00236"></a>00236 
<a name="l00237"></a>00237         i = *<a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a>;
<a name="l00238"></a>00238 
<a name="l00239"></a>00239         <span class="comment">// i = x+y*width so</span>
<a name="l00240"></a>00240         y = i/<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00241"></a>00241         x = i-y*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00242"></a>00242 
<a name="l00243"></a>00243         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#ab53eb16e33ba58b3bb9402a186d71d31" title="To compute the external speed Fd for a current point (x,y) of Lout or Lin.">compute_external_speed_Fd</a>(i,x,y) &lt; 0 ) {
<a name="l00244"></a>00244 
<a name="l00245"></a>00245             <a class="code" href="classofeli_1_1_active_contour.html#ae938fd6dcb59480b9262c64094613984" title="Specific step reimplemented in the children active contours ACwithoutEdges and ACwithoutEdgesYUV to u...">do_specific_out_step</a>(i,x,y); <span class="comment">// updates of the variables to calculate the means Cout and Cin</span>
<a name="l00246"></a>00246 
<a name="l00247"></a>00247             <a class="code" href="classofeli_1_1_active_contour.html#a6c32060c165e04d1eb9cc0895c7c65ba" title="Inward local movement of the curve for a current point (x,y) of Lin that is switched in Lout...">switch_out</a>(i,x,y); <span class="comment">// inward local movement</span>
<a name="l00248"></a>00248 
<a name="l00249"></a>00249             <span class="keywordflow">if</span>( !<a class="code" href="classofeli_1_1_active_contour.html#af437460aa2cdf312166a3fe4d54beeb4" title="Boolean egals to true if one point of Lin at least is switched out during the scan throw the Lin list...">hasInwardEvolution</a> ) {
<a name="l00250"></a>00250                 <a class="code" href="classofeli_1_1_active_contour.html#af437460aa2cdf312166a3fe4d54beeb4" title="Boolean egals to true if one point of Lin at least is switched out during the scan throw the Lin list...">hasInwardEvolution</a> = <span class="keyword">true</span>;
<a name="l00251"></a>00251             }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253         }
<a name="l00254"></a>00254         <span class="keywordflow">else</span> {
<a name="l00255"></a>00255             ++<a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a>;
<a name="l00256"></a>00256         }
<a name="l00257"></a>00257 
<a name="l00258"></a>00258     }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260     <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#af437460aa2cdf312166a3fe4d54beeb4" title="Boolean egals to true if one point of Lin at least is switched out during the scan throw the Lin list...">hasInwardEvolution</a> &amp;&amp; <a class="code" href="classofeli_1_1_active_contour.html#a8d7a7c8b12556672bb052a84ae7f9671" title="Boolean egals to true to eliminate the redundant points in Lin and Lout lists.">hasCleaning</a> ) {
<a name="l00261"></a>00261         <a class="code" href="classofeli_1_1_active_contour.html#a33de623e3a4aefe9f31b6ec28428f807" title="To eliminate redundant points in Lout.">eliminate_redundant_in_Lout</a>(); <span class="comment">// Lout boundary cleaning</span>
<a name="l00262"></a>00262     }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264     <a class="code" href="classofeli_1_1_active_contour.html#a7c7275006d98705cd7f04f8a7fe7e697" title="First stopping condition called at the end of each iteration of the cycle 1. Update of hasListsChange...">calculate_stopping_conditions1</a>();
<a name="l00265"></a>00265 
<a name="l00266"></a>00266     <span class="keywordflow">return</span>;
<a name="l00267"></a>00267 }
<a name="l00268"></a>00268 
<a name="l00269"></a><a class="code" href="classofeli_1_1_active_contour.html#a7cf8243140d8ef8f72a638e9a1442dc2">00269</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a7cf8243140d8ef8f72a638e9a1442dc2" title="Function called by evolve_one_iteration() for a curve smoothing or internal evolution with Fint speed...">ActiveContour::do_one_iteration_in_cycle2</a>() {
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     <span class="keywordtype">int</span> i; <span class="comment">// offset of the current pixel for the image data buffer or phi</span>
<a name="l00272"></a>00272 
<a name="l00273"></a>00273     <span class="keywordtype">int</span> x, y; <span class="comment">// position of the current pixel</span>
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     <span class="comment">// scan through Lout</span>
<a name="l00276"></a>00276     <span class="keywordflow">for</span>( <a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a> = <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>.begin(); <a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a> != <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>.end();  ) {
<a name="l00277"></a>00277 
<a name="l00278"></a>00278         i = *<a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a>;
<a name="l00279"></a>00279 
<a name="l00280"></a>00280         <span class="comment">// i = x+y*width so</span>
<a name="l00281"></a>00281         y = i/<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00282"></a>00282         x = i-y*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a> == <a class="code" href="classofeli_1_1_active_contour.html#a908322f93a50ce7808960236478649fe" title="Number of maximum iterations the active contour evolves in the cycle 2 with Fint speed.">Ns_max</a>-1 ) {
<a name="l00285"></a>00285             <a class="code" href="classofeli_1_1_active_contour.html#aefe0738d8a43f3981d591a0cc78ed717" title="Length of Lin + length of Lout.">lists_length</a>++;
<a name="l00286"></a>00286         }
<a name="l00287"></a>00287 
<a name="l00288"></a>00288         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a73d4494adc5b2c3b595dc013a8af17bd" title="To compute the internal speed Fint for a current point (x,y) of Lout or Lin.">compute_internal_speed_Fint</a>(i,x,y) &lt; 0 ) {
<a name="l00289"></a>00289 
<a name="l00290"></a>00290             <a class="code" href="classofeli_1_1_active_contour.html#a29ffb870edb974dc2ab0a1851e2483bf" title="Specific step reimplemented in the children active contours ACwithoutEdges and ACwithoutEdgesYUV to u...">do_specific_in_step2</a>(i,x,y); <span class="comment">// updates of the variables to calculate the means Cout and Cin</span>
<a name="l00291"></a>00291 
<a name="l00292"></a>00292             <a class="code" href="classofeli_1_1_active_contour.html#ae503203f7eed34136805ea11175dcc62" title="Outward local movement of the curve for a current point (x,y) of Lout that is switched in Lin...">switch_in</a>(i,x,y); <span class="comment">// outward local movement</span>
<a name="l00293"></a>00293 
<a name="l00294"></a>00294         }
<a name="l00295"></a>00295         <span class="keywordflow">else</span> {
<a name="l00296"></a>00296             ++<a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a>;
<a name="l00297"></a>00297         }
<a name="l00298"></a>00298 
<a name="l00299"></a>00299     }
<a name="l00300"></a>00300 
<a name="l00301"></a>00301     <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a8d7a7c8b12556672bb052a84ae7f9671" title="Boolean egals to true to eliminate the redundant points in Lin and Lout lists.">hasCleaning</a> ) {
<a name="l00302"></a>00302         <a class="code" href="classofeli_1_1_active_contour.html#a2fbcb81cc03239dae86e7a235dd64e00" title="To eliminate redundant points in Lin.">eliminate_redundant_in_Lin</a>(); <span class="comment">// Lin boundary cleaning</span>
<a name="l00303"></a>00303     }
<a name="l00304"></a>00304 
<a name="l00305"></a>00305     <span class="comment">// scan through Lin</span>
<a name="l00306"></a>00306     <span class="keywordflow">for</span>( <a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a> = <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>.begin(); <a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a> != <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>.end();  ) {
<a name="l00307"></a>00307 
<a name="l00308"></a>00308         i = *<a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a>;
<a name="l00309"></a>00309 
<a name="l00310"></a>00310         <span class="comment">// i = x+y*width so</span>
<a name="l00311"></a>00311         y = i/<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00312"></a>00312         x = i-y*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00313"></a>00313 
<a name="l00314"></a>00314         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a> == <a class="code" href="classofeli_1_1_active_contour.html#a908322f93a50ce7808960236478649fe" title="Number of maximum iterations the active contour evolves in the cycle 2 with Fint speed.">Ns_max</a>-1 ) {
<a name="l00315"></a>00315             <a class="code" href="classofeli_1_1_active_contour.html#aefe0738d8a43f3981d591a0cc78ed717" title="Length of Lin + length of Lout.">lists_length</a>++;
<a name="l00316"></a>00316         }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a73d4494adc5b2c3b595dc013a8af17bd" title="To compute the internal speed Fint for a current point (x,y) of Lout or Lin.">compute_internal_speed_Fint</a>(i,x,y) &gt; 0 ) {
<a name="l00319"></a>00319 
<a name="l00320"></a>00320             <a class="code" href="classofeli_1_1_active_contour.html#a265bec94de92dfa81d786099bcbc30ab" title="Specific step reimplemented in the children active contours ACwithoutEdges and ACwithoutEdgesYUV to u...">do_specific_out_step2</a>(i,x,y); <span class="comment">// updates of the variables to calculate the means Cout and Cin</span>
<a name="l00321"></a>00321 
<a name="l00322"></a>00322             <a class="code" href="classofeli_1_1_active_contour.html#a6c32060c165e04d1eb9cc0895c7c65ba" title="Inward local movement of the curve for a current point (x,y) of Lin that is switched in Lout...">switch_out</a>(i,x,y); <span class="comment">// inward local movement</span>
<a name="l00323"></a>00323 
<a name="l00324"></a>00324         }
<a name="l00325"></a>00325         <span class="keywordflow">else</span> {
<a name="l00326"></a>00326             ++<a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a>;
<a name="l00327"></a>00327         }
<a name="l00328"></a>00328 
<a name="l00329"></a>00329     }
<a name="l00330"></a>00330 
<a name="l00331"></a>00331     <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a8d7a7c8b12556672bb052a84ae7f9671" title="Boolean egals to true to eliminate the redundant points in Lin and Lout lists.">hasCleaning</a> ) {
<a name="l00332"></a>00332         <a class="code" href="classofeli_1_1_active_contour.html#a33de623e3a4aefe9f31b6ec28428f807" title="To eliminate redundant points in Lout.">eliminate_redundant_in_Lout</a>(); <span class="comment">// Lout boundary cleaning</span>
<a name="l00333"></a>00333     }
<a name="l00334"></a>00334 
<a name="l00335"></a>00335     <a class="code" href="classofeli_1_1_active_contour.html#ac155630f750a4811ddbcb5c3b0aff2df" title="Number of times the active contour evolves.">iterations</a>++;
<a name="l00336"></a>00336 
<a name="l00337"></a>00337     <span class="keywordflow">return</span>;
<a name="l00338"></a>00338 }
<a name="l00339"></a>00339 
<a name="l00340"></a><a class="code" href="classofeli_1_1_active_contour.html#a7ec7567e8af8bc1bce4b310f7d01be72">00340</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a7ec7567e8af8bc1bce4b310f7d01be72" title="To evolve the active contour of one iteration or one step. This function calls the functions do_one_i...">ActiveContour::evolve_one_iteration</a>() {
<a name="l00341"></a>00341 
<a name="l00342"></a>00342     <span class="keywordflow">if</span>( !<a class="code" href="classofeli_1_1_active_contour.html#ac239b94976782c0769bda5d2b1e3d1b8" title="Boolean egals to true to stop the algorithm.">hasAlgoStopping</a> ) {
<a name="l00343"></a>00343 
<a name="l00344"></a>00344         <span class="comment">// Na_max iterations in the cycle 1</span>
<a name="l00345"></a>00345         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a2ff3ef2151ddf1e7f9f260ad9bf3d6f2" title="Boolean egals to false to go away the cycle 1 and never to go back into.">hasCycle1</a> ) {
<a name="l00346"></a>00346 
<a name="l00347"></a>00347             <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a> &lt; <a class="code" href="classofeli_1_1_active_contour.html#a811a28ec9c39400d244783a8a2fe7e2d" title="Number of maximum iterations the active contour evolves in the cycle 1 with Fd speed.">Na_max</a>-1 ) {
<a name="l00348"></a>00348                 <a class="code" href="classofeli_1_1_active_contour.html#a2ab521c583572158549d416ccc755f3a" title="Function called by evolve_one_iteration() for external or data dependant evolution with Fd speed...">do_one_iteration_in_cycle1</a>(); <span class="comment">// data dependant evolution</span>
<a name="l00349"></a>00349                 <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a>++;
<a name="l00350"></a>00350                 <span class="keywordflow">return</span>;
<a name="l00351"></a>00351             }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353             <span class="comment">// last iteration of the cycle 1</span>
<a name="l00354"></a>00354             <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a> == <a class="code" href="classofeli_1_1_active_contour.html#a811a28ec9c39400d244783a8a2fe7e2d" title="Number of maximum iterations the active contour evolves in the cycle 1 with Fd speed.">Na_max</a>-1 ) {
<a name="l00355"></a>00355                 <a class="code" href="classofeli_1_1_active_contour.html#a2ab521c583572158549d416ccc755f3a" title="Function called by evolve_one_iteration() for external or data dependant evolution with Fd speed...">do_one_iteration_in_cycle1</a>(); <span class="comment">// data dependant evolution</span>
<a name="l00356"></a>00356                 <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a2d78fdef72930323ab6bdd38b167afa1" title="Boolean egals to true to have the curve smoothing, evolutions in the cycle 2 with the internal speed ...">hasSmoothingCycle</a> ) {
<a name="l00357"></a>00357                     <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a>++; <span class="comment">// in order to do the cycle2, now Na=Na_max</span>
<a name="l00358"></a>00358                 }
<a name="l00359"></a>00359                 <span class="keywordflow">else</span> {
<a name="l00360"></a>00360                     <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a> = 0; <span class="comment">// in order to restart the cycle1</span>
<a name="l00361"></a>00361                 }
<a name="l00362"></a>00362                 <span class="keywordflow">return</span>;
<a name="l00363"></a>00363             }
<a name="l00364"></a>00364 
<a name="l00365"></a>00365         }
<a name="l00366"></a>00366 
<a name="l00367"></a>00367         <span class="comment">// Ns_max iterations in the cycle 2</span>
<a name="l00368"></a>00368         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a2d78fdef72930323ab6bdd38b167afa1" title="Boolean egals to true to have the curve smoothing, evolutions in the cycle 2 with the internal speed ...">hasSmoothingCycle</a> ) {
<a name="l00369"></a>00369 
<a name="l00370"></a>00370             <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a> &lt; <a class="code" href="classofeli_1_1_active_contour.html#a908322f93a50ce7808960236478649fe" title="Number of maximum iterations the active contour evolves in the cycle 2 with Fint speed.">Ns_max</a>-1 ) {
<a name="l00371"></a>00371                 <a class="code" href="classofeli_1_1_active_contour.html#a7cf8243140d8ef8f72a638e9a1442dc2" title="Function called by evolve_one_iteration() for a curve smoothing or internal evolution with Fint speed...">do_one_iteration_in_cycle2</a>(); <span class="comment">// ac regularization</span>
<a name="l00372"></a>00372                 <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a>++;
<a name="l00373"></a>00373                 <span class="keywordflow">return</span>;
<a name="l00374"></a>00374             }
<a name="l00375"></a>00375 
<a name="l00376"></a>00376             <span class="comment">// last iteration of the cycle 2</span>
<a name="l00377"></a>00377             <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a> == <a class="code" href="classofeli_1_1_active_contour.html#a908322f93a50ce7808960236478649fe" title="Number of maximum iterations the active contour evolves in the cycle 2 with Fint speed.">Ns_max</a>-1 ) {
<a name="l00378"></a>00378                 <a class="code" href="classofeli_1_1_active_contour.html#a7cf8243140d8ef8f72a638e9a1442dc2" title="Function called by evolve_one_iteration() for a curve smoothing or internal evolution with Fint speed...">do_one_iteration_in_cycle2</a>(); <span class="comment">// ac regularization</span>
<a name="l00379"></a>00379                 <a class="code" href="classofeli_1_1_active_contour.html#a218109b08dd520c95ee7613235bb0593" title="Second stopping condition called at the end of the cycle 2. Update of hasOscillation. Two tests on hasOscillation and iterations are done. If one test is positive, hasAlgoStopping egals to true and the active contour stops.">calculate_stopping_conditions2</a>();
<a name="l00380"></a>00380                 <span class="comment">// in order to restart the both cycles</span>
<a name="l00381"></a>00381                 <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a> = 0;
<a name="l00382"></a>00382                 <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a> = 0;
<a name="l00383"></a>00383                 <span class="keywordflow">return</span>;
<a name="l00384"></a>00384             }
<a name="l00385"></a>00385         }
<a name="l00386"></a>00386     }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388     <span class="keywordflow">return</span>;
<a name="l00389"></a>00389 }
<a name="l00390"></a>00390 
<a name="l00391"></a>00391 <span class="comment">// 2 functions to evolve the active contour</span>
<a name="l00392"></a><a class="code" href="classofeli_1_1_active_contour.html#a8eaa11cf2095e8429526170b238bae38">00392</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a8eaa11cf2095e8429526170b238bae38" title="To evolve the active contour n times or n iterations.">ActiveContour::evolve_n_iterations</a>(<span class="keywordtype">int</span> n) {
<a name="l00393"></a>00393 
<a name="l00394"></a>00394     <span class="keyword">const</span> <span class="keywordtype">int</span> N = <a class="code" href="classofeli_1_1_active_contour.html#ac155630f750a4811ddbcb5c3b0aff2df" title="Number of times the active contour evolves.">iterations</a>+n;
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     <span class="keywordflow">while</span>( !<a class="code" href="classofeli_1_1_active_contour.html#ac239b94976782c0769bda5d2b1e3d1b8" title="Boolean egals to true to stop the algorithm.">hasAlgoStopping</a> &amp;&amp; <a class="code" href="classofeli_1_1_active_contour.html#ac155630f750a4811ddbcb5c3b0aff2df" title="Number of times the active contour evolves.">iterations</a> &lt; N ) {
<a name="l00397"></a>00397 
<a name="l00398"></a>00398         <span class="keywordflow">for</span>(  ; <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a> &lt; <a class="code" href="classofeli_1_1_active_contour.html#a811a28ec9c39400d244783a8a2fe7e2d" title="Number of maximum iterations the active contour evolves in the cycle 1 with Fd speed.">Na_max</a> &amp;&amp; <a class="code" href="classofeli_1_1_active_contour.html#a2ff3ef2151ddf1e7f9f260ad9bf3d6f2" title="Boolean egals to false to go away the cycle 1 and never to go back into.">hasCycle1</a> &amp;&amp; <a class="code" href="classofeli_1_1_active_contour.html#ac155630f750a4811ddbcb5c3b0aff2df" title="Number of times the active contour evolves.">iterations</a> &lt; N; <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a>++ ) {
<a name="l00399"></a>00399             <a class="code" href="classofeli_1_1_active_contour.html#a2ab521c583572158549d416ccc755f3a" title="Function called by evolve_one_iteration() for external or data dependant evolution with Fd speed...">do_one_iteration_in_cycle1</a>();
<a name="l00400"></a>00400         }
<a name="l00401"></a>00401         <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a> = 0;
<a name="l00402"></a>00402 
<a name="l00403"></a>00403         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a2d78fdef72930323ab6bdd38b167afa1" title="Boolean egals to true to have the curve smoothing, evolutions in the cycle 2 with the internal speed ...">hasSmoothingCycle</a> ) {
<a name="l00404"></a>00404 
<a name="l00405"></a>00405             <span class="keywordflow">for</span>(  ; <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a> &lt; <a class="code" href="classofeli_1_1_active_contour.html#a908322f93a50ce7808960236478649fe" title="Number of maximum iterations the active contour evolves in the cycle 2 with Fint speed.">Ns_max</a> &amp;&amp; <a class="code" href="classofeli_1_1_active_contour.html#ac155630f750a4811ddbcb5c3b0aff2df" title="Number of times the active contour evolves.">iterations</a> &lt; N; <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a>++ ) {
<a name="l00406"></a>00406                 <a class="code" href="classofeli_1_1_active_contour.html#a7cf8243140d8ef8f72a638e9a1442dc2" title="Function called by evolve_one_iteration() for a curve smoothing or internal evolution with Fint speed...">do_one_iteration_in_cycle2</a>();
<a name="l00407"></a>00407             }
<a name="l00408"></a>00408             <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a> = 0;
<a name="l00409"></a>00409             <a class="code" href="classofeli_1_1_active_contour.html#a218109b08dd520c95ee7613235bb0593" title="Second stopping condition called at the end of the cycle 2. Update of hasOscillation. Two tests on hasOscillation and iterations are done. If one test is positive, hasAlgoStopping egals to true and the active contour stops.">calculate_stopping_conditions2</a>();
<a name="l00410"></a>00410         }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412     }
<a name="l00413"></a>00413 
<a name="l00414"></a>00414     <span class="keywordflow">return</span>;
<a name="l00415"></a>00415 }
<a name="l00416"></a>00416 
<a name="l00417"></a><a class="code" href="classofeli_1_1_active_contour.html#adb4b25587c73924176f5ed3477ec54f7">00417</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#adb4b25587c73924176f5ed3477ec54f7" title="To evolve directly the active contour at the final state, when hasAlgoStopping egals to true...">ActiveContour::evolve_to_final_state</a>() {
<a name="l00418"></a>00418 
<a name="l00419"></a>00419     <span class="keywordflow">while</span>( !<a class="code" href="classofeli_1_1_active_contour.html#ac239b94976782c0769bda5d2b1e3d1b8" title="Boolean egals to true to stop the algorithm.">hasAlgoStopping</a> ) {
<a name="l00420"></a>00420 
<a name="l00421"></a>00421         <span class="keywordflow">for</span>(  ; <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a> &lt; <a class="code" href="classofeli_1_1_active_contour.html#a811a28ec9c39400d244783a8a2fe7e2d" title="Number of maximum iterations the active contour evolves in the cycle 1 with Fd speed.">Na_max</a> &amp;&amp; <a class="code" href="classofeli_1_1_active_contour.html#a2ff3ef2151ddf1e7f9f260ad9bf3d6f2" title="Boolean egals to false to go away the cycle 1 and never to go back into.">hasCycle1</a>; <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a>++ ) {
<a name="l00422"></a>00422             <a class="code" href="classofeli_1_1_active_contour.html#a2ab521c583572158549d416ccc755f3a" title="Function called by evolve_one_iteration() for external or data dependant evolution with Fd speed...">do_one_iteration_in_cycle1</a>();
<a name="l00423"></a>00423         }
<a name="l00424"></a>00424         <a class="code" href="classofeli_1_1_active_contour.html#a59f111cd0910d2e6534b51bb1da3c254" title="Number of iterations the active contour evolves in the cycle 1 with Fd speed.">Na</a> = 0;
<a name="l00425"></a>00425 
<a name="l00426"></a>00426         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a2d78fdef72930323ab6bdd38b167afa1" title="Boolean egals to true to have the curve smoothing, evolutions in the cycle 2 with the internal speed ...">hasSmoothingCycle</a> ) {
<a name="l00427"></a>00427 
<a name="l00428"></a>00428             <span class="keywordflow">for</span>(  ; <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a> &lt; <a class="code" href="classofeli_1_1_active_contour.html#a908322f93a50ce7808960236478649fe" title="Number of maximum iterations the active contour evolves in the cycle 2 with Fint speed.">Ns_max</a>; <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a>++ ) {
<a name="l00429"></a>00429                 <a class="code" href="classofeli_1_1_active_contour.html#a7cf8243140d8ef8f72a638e9a1442dc2" title="Function called by evolve_one_iteration() for a curve smoothing or internal evolution with Fint speed...">do_one_iteration_in_cycle2</a>();
<a name="l00430"></a>00430             }
<a name="l00431"></a>00431             <a class="code" href="classofeli_1_1_active_contour.html#a38cc27ae9706801882322f02b5db2df8" title="Number of iterations the active contour evolves in the cycle 2 with Fint speed.">Ns</a> = 0;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433             <a class="code" href="classofeli_1_1_active_contour.html#a218109b08dd520c95ee7613235bb0593" title="Second stopping condition called at the end of the cycle 2. Update of hasOscillation. Two tests on hasOscillation and iterations are done. If one test is positive, hasAlgoStopping egals to true and the active contour stops.">calculate_stopping_conditions2</a>();
<a name="l00434"></a>00434         }
<a name="l00435"></a>00435     }
<a name="l00436"></a>00436 
<a name="l00437"></a>00437     <span class="keywordflow">return</span>;
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 
<a name="l00440"></a><a class="code" href="classofeli_1_1_active_contour.html#ae503203f7eed34136805ea11175dcc62">00440</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#ae503203f7eed34136805ea11175dcc62" title="Outward local movement of the curve for a current point (x,y) of Lout that is switched in Lin...">ActiveContour::switch_in</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
<a name="l00441"></a>00441 
<a name="l00442"></a>00442     <span class="comment">// Outward local movement</span>
<a name="l00443"></a>00443     <span class="comment">// current point (x,y) of Lout is switched in Lin</span>
<a name="l00444"></a>00444 
<a name="l00445"></a>00445     <span class="comment">// if not in the border of the image, no neighbor test</span>
<a name="l00446"></a>00446     <span class="keywordflow">if</span>( x &gt; 0 &amp;&amp; x &lt; width-1 &amp;&amp; y &gt; 0 &amp;&amp; y &lt; <a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>-1 ) {
<a name="l00447"></a>00447 
<a name="l00448"></a>00448         <span class="comment">// scan through a 8-connex neighborhood</span>
<a name="l00449"></a>00449         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dy = -1; dy &lt;= 1; dy++ ) {
<a name="l00450"></a>00450             <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dx = -1; dx &lt;= 1; dx++ ) {
<a name="l00451"></a>00451                 <span class="keywordflow">if</span>( !( dx == 0 &amp;&amp; dy == 0 ) ) {
<a name="l00452"></a>00452 
<a name="l00453"></a>00453                     <span class="comment">// if a neighbor ∈ Rout</span>
<a name="l00454"></a>00454                     <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[ (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> ] == 3 ) {
<a name="l00455"></a>00455 
<a name="l00456"></a>00456                         <span class="comment">// phi(neighbor) = 3 --&gt; 1</span>
<a name="l00457"></a>00457                         <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[ (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> ] = 1;
<a name="l00458"></a>00458 
<a name="l00459"></a>00459                         <span class="comment">// neighbor ∈ Rout --&gt; ∈ Lout</span>
<a name="l00460"></a>00460                         <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>.push_front( (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> );
<a name="l00461"></a>00461 
<a name="l00462"></a>00462                     }
<a name="l00463"></a>00463                 }
<a name="l00464"></a>00464             }
<a name="l00465"></a>00465         }
<a name="l00466"></a>00466     }
<a name="l00467"></a>00467 
<a name="l00468"></a>00468     <span class="comment">// if in the border, neighbors tests</span>
<a name="l00469"></a>00469     <span class="keywordflow">else</span> {
<a name="l00470"></a>00470 
<a name="l00471"></a>00471         <span class="comment">// scan through a 8-connex neighborhood</span>
<a name="l00472"></a>00472         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dy = -1; dy &lt;= 1; dy++ ) {
<a name="l00473"></a>00473             <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dx = -1; dx &lt;= 1; dx++ ) {
<a name="l00474"></a>00474                 <span class="keywordflow">if</span>( !( dx == 0 &amp;&amp; dy == 0 ) ) {
<a name="l00475"></a>00475 
<a name="l00476"></a>00476                     <span class="comment">// existence tests</span>
<a name="l00477"></a>00477                     <span class="keywordflow">if</span>( x+dx &gt;= 0 &amp;&amp; x+dx &lt; width &amp;&amp; y+dy &gt;= 0 &amp;&amp; y+dy &lt; <a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a> ) {
<a name="l00478"></a>00478 
<a name="l00479"></a>00479                         <span class="comment">// if a neighbor ∈ Rout</span>
<a name="l00480"></a>00480                         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[ (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> ] == 3 ) {
<a name="l00481"></a>00481 
<a name="l00482"></a>00482                             <span class="comment">// phi(neighbor) = 3 --&gt; 1</span>
<a name="l00483"></a>00483                             <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[ (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> ] = 1;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485                             <span class="comment">// neighbor ∈ Rout --&gt; ∈ Lout</span>
<a name="l00486"></a>00486                             <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>.push_front( (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> );
<a name="l00487"></a>00487                         }
<a name="l00488"></a>00488                     }
<a name="l00489"></a>00489                 }
<a name="l00490"></a>00490             }
<a name="l00491"></a>00491         }
<a name="l00492"></a>00492     }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494     <span class="comment">// current point ∈ Lout --&gt; ∈ Lin</span>
<a name="l00495"></a>00495 
<a name="l00496"></a>00496     <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>.push_front(i);
<a name="l00497"></a>00497 
<a name="l00498"></a>00498     <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[i] = -1; <span class="comment">// phi(point) = 1 --&gt; -1</span>
<a name="l00499"></a>00499 
<a name="l00500"></a>00500     <a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a> = <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>.erase(<a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a>);
<a name="l00501"></a>00501 
<a name="l00502"></a>00502     <span class="keywordflow">return</span>;
<a name="l00503"></a>00503 }
<a name="l00504"></a>00504 
<a name="l00505"></a><a class="code" href="classofeli_1_1_active_contour.html#a6c32060c165e04d1eb9cc0895c7c65ba">00505</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a6c32060c165e04d1eb9cc0895c7c65ba" title="Inward local movement of the curve for a current point (x,y) of Lin that is switched in Lout...">ActiveContour::switch_out</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
<a name="l00506"></a>00506 
<a name="l00507"></a>00507     <span class="comment">// Inward local movement</span>
<a name="l00508"></a>00508     <span class="comment">// current point (x,y) of Lin is switched in Lout</span>
<a name="l00509"></a>00509 
<a name="l00510"></a>00510     <span class="comment">// if not in the border of the image, no neighbor tests</span>
<a name="l00511"></a>00511     <span class="keywordflow">if</span>( x &gt; 0 &amp;&amp; x &lt; width-1 &amp;&amp; y &gt; 0 &amp;&amp; y &lt; <a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>-1 ) {
<a name="l00512"></a>00512 
<a name="l00513"></a>00513         <span class="comment">// scan through a 8-connex neighborhood</span>
<a name="l00514"></a>00514         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dy = -1; dy &lt;= 1; dy++ ) {
<a name="l00515"></a>00515             <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dx = -1; dx &lt;= 1; dx++ ) {
<a name="l00516"></a>00516                 <span class="keywordflow">if</span>( !( dx == 0 &amp;&amp; dy == 0 ) ) {
<a name="l00517"></a>00517 
<a name="l00518"></a>00518                     <span class="comment">// if a neighbor ∈ Rin</span>
<a name="l00519"></a>00519                     <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[ (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> ] == -3 ) {
<a name="l00520"></a>00520 
<a name="l00521"></a>00521                         <span class="comment">// phi(neighbor) = -3 --&gt; -1</span>
<a name="l00522"></a>00522                         <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[ (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> ] = -1;
<a name="l00523"></a>00523 
<a name="l00524"></a>00524                         <span class="comment">// neighbor ∈ Rin --&gt; ∈ Lin</span>
<a name="l00525"></a>00525                         <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>.push_front( (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> );
<a name="l00526"></a>00526                     }
<a name="l00527"></a>00527                 }
<a name="l00528"></a>00528             }
<a name="l00529"></a>00529         }
<a name="l00530"></a>00530     }
<a name="l00531"></a>00531 
<a name="l00532"></a>00532     <span class="comment">// if in the border, neighbors tests</span>
<a name="l00533"></a>00533     <span class="keywordflow">else</span> {
<a name="l00534"></a>00534 
<a name="l00535"></a>00535         <span class="comment">// scan through a 8-connex neighborhood</span>
<a name="l00536"></a>00536         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dy = -1; dy &lt;= 1; dy++ ) {
<a name="l00537"></a>00537             <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dx = -1; dx &lt;= 1; dx++ ) {
<a name="l00538"></a>00538                 <span class="keywordflow">if</span>( !( dx == 0 &amp;&amp; dy == 0 ) ) {
<a name="l00539"></a>00539 
<a name="l00540"></a>00540                     <span class="comment">// existence tests</span>
<a name="l00541"></a>00541                     <span class="keywordflow">if</span>( x+dx &gt;= 0 &amp;&amp; x+dx &lt; width &amp;&amp; y+dy &gt;= 0 &amp;&amp; y+dy &lt; <a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a> ) {
<a name="l00542"></a>00542 
<a name="l00543"></a>00543                         <span class="comment">// if a neighbor ∈ Rin</span>
<a name="l00544"></a>00544                         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[ (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> ] == -3 ) {
<a name="l00545"></a>00545 
<a name="l00546"></a>00546                             <span class="comment">// phi(neighbor) = -3 --&gt; -1</span>
<a name="l00547"></a>00547                             <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[ (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> ] = -1;
<a name="l00548"></a>00548 
<a name="l00549"></a>00549                             <span class="comment">// neighbor ∈ Rin --&gt; ∈ Lin</span>
<a name="l00550"></a>00550                             <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>.push_front( (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> );
<a name="l00551"></a>00551                         }
<a name="l00552"></a>00552                     }
<a name="l00553"></a>00553                 }
<a name="l00554"></a>00554             }
<a name="l00555"></a>00555         }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557     }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559     <span class="comment">// current point ∈ Lin --&gt; ∈ Lout</span>
<a name="l00560"></a>00560 
<a name="l00561"></a>00561     <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>.push_front(i);
<a name="l00562"></a>00562 
<a name="l00563"></a>00563     <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[i] = 1; <span class="comment">// phi(point) = -1 --&gt; 1</span>
<a name="l00564"></a>00564 
<a name="l00565"></a>00565     <a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a> = <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>.erase(<a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a>);
<a name="l00566"></a>00566 
<a name="l00567"></a>00567     <span class="keywordflow">return</span>;
<a name="l00568"></a>00568 }
<a name="l00569"></a>00569 
<a name="l00570"></a><a class="code" href="classofeli_1_1_active_contour.html#a73d4494adc5b2c3b595dc013a8af17bd">00570</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classofeli_1_1_active_contour.html#a73d4494adc5b2c3b595dc013a8af17bd" title="To compute the internal speed Fint for a current point (x,y) of Lout or Lin.">ActiveContour::compute_internal_speed_Fint</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
<a name="l00571"></a>00571 
<a name="l00572"></a>00572     <span class="keywordtype">int</span> Fint = 0;
<a name="l00573"></a>00573 
<a name="l00574"></a>00574     <span class="comment">// if not in the border of the image, no neighbor test</span>
<a name="l00575"></a>00575     <span class="keywordflow">if</span>( x &gt; <a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>-1 &amp;&amp; x &lt; width-kernel_radius &amp;&amp; y &gt; <a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>-1 &amp;&amp; y &lt; <a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>-<a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a> ) {
<a name="l00576"></a>00576         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dy = -<a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>; dy &lt;= <a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>; dy++ ) {
<a name="l00577"></a>00577             <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dx = -<a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>; dx &lt;= <a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>; dx++ ) {
<a name="l00578"></a>00578                 Fint += <a class="code" href="classofeli_1_1_active_contour.html#a0f8558877cf436d932838173ba5b8061" title="Pointer on the gaussian kernel buffer used to calculate Fint.">gaussian_kernel</a>[ (<a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>+dx)+(<a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>+dy)*<a class="code" href="classofeli_1_1_active_contour.html#a2b32161d0a9ac64a4e4f4c242fabe27c" title="Kernel length of the gaussian filter for the curve smoothing.">kernel_length</a> ]*<a class="code" href="classofeli_1_1_active_contour.html#a6a5c4de6a67bb33cb6d75655811c3e5c" title="To give the sign of phi. Return the integer -1 or 1;.">give_sign_of_phi</a>( (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> );
<a name="l00579"></a>00579             }
<a name="l00580"></a>00580         }
<a name="l00581"></a>00581     }
<a name="l00582"></a>00582     <span class="comment">// if in the border of the image, tests of neighbors</span>
<a name="l00583"></a>00583     <span class="keywordflow">else</span> {
<a name="l00584"></a>00584         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dy = -<a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>; dy &lt;= <a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>; dy++ ) {
<a name="l00585"></a>00585             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dx = -<a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>; dx &lt;= <a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>; dx++ ) {
<a name="l00586"></a>00586                 <span class="keywordflow">if</span>( x+dx &gt;= 0 &amp;&amp; x+dx &lt; width &amp;&amp; y+dy &gt;= 0 &amp;&amp; y+dy &lt; <a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a> ) {
<a name="l00587"></a>00587                     Fint += <a class="code" href="classofeli_1_1_active_contour.html#a0f8558877cf436d932838173ba5b8061" title="Pointer on the gaussian kernel buffer used to calculate Fint.">gaussian_kernel</a>[ (<a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>+dx)+(<a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>+dy)*<a class="code" href="classofeli_1_1_active_contour.html#a2b32161d0a9ac64a4e4f4c242fabe27c" title="Kernel length of the gaussian filter for the curve smoothing.">kernel_length</a> ]*<a class="code" href="classofeli_1_1_active_contour.html#a6a5c4de6a67bb33cb6d75655811c3e5c" title="To give the sign of phi. Return the integer -1 or 1;.">give_sign_of_phi</a>( (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> );
<a name="l00588"></a>00588                 }
<a name="l00589"></a>00589                 <span class="keywordflow">else</span> {
<a name="l00590"></a>00590                     Fint += <a class="code" href="classofeli_1_1_active_contour.html#a0f8558877cf436d932838173ba5b8061" title="Pointer on the gaussian kernel buffer used to calculate Fint.">gaussian_kernel</a>[ (<a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>+dx)+(<a class="code" href="classofeli_1_1_active_contour.html#a00740d5331e8d4f60c1345cc8cabf7ad" title="kernel_radius = ( kernel_length - 1) / 2 with kernel_length impair.">kernel_radius</a>+dy)*<a class="code" href="classofeli_1_1_active_contour.html#a2b32161d0a9ac64a4e4f4c242fabe27c" title="Kernel length of the gaussian filter for the curve smoothing.">kernel_length</a> ]*<a class="code" href="classofeli_1_1_active_contour.html#a6a5c4de6a67bb33cb6d75655811c3e5c" title="To give the sign of phi. Return the integer -1 or 1;.">give_sign_of_phi</a>(i);
<a name="l00591"></a>00591                 }
<a name="l00592"></a>00592             }
<a name="l00593"></a>00593         }
<a name="l00594"></a>00594     }
<a name="l00595"></a>00595 
<a name="l00596"></a>00596     <span class="keywordflow">return</span> Fint;
<a name="l00597"></a>00597 }
<a name="l00598"></a>00598 
<a name="l00599"></a><a class="code" href="classofeli_1_1_active_contour.html#a6a5c4de6a67bb33cb6d75655811c3e5c">00599</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classofeli_1_1_active_contour.html#a6a5c4de6a67bb33cb6d75655811c3e5c" title="To give the sign of phi. Return the integer -1 or 1;.">ActiveContour::give_sign_of_phi</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const </span>{
<a name="l00600"></a>00600     <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[i] &lt; 0 ) {
<a name="l00601"></a>00601         <span class="keywordflow">return</span> -1;
<a name="l00602"></a>00602     }
<a name="l00603"></a>00603     <span class="keywordflow">else</span> {
<a name="l00604"></a>00604         <span class="keywordflow">return</span> 1;
<a name="l00605"></a>00605     }
<a name="l00606"></a>00606 }
<a name="l00607"></a>00607 
<a name="l00608"></a><a class="code" href="classofeli_1_1_active_contour.html#aa48c1dcf4663b546403254294b481c12">00608</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classofeli_1_1_active_contour.html#aa48c1dcf4663b546403254294b481c12" title="To find if a current point (x,y) of Lin is redundant.">ActiveContour::find_isRedundantPointOfLin</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)<span class="keyword"> const </span>{
<a name="l00609"></a>00609 
<a name="l00610"></a>00610     <span class="comment">// if not in the border of the image, no neighbor test</span>
<a name="l00611"></a>00611     <span class="keywordflow">if</span>( x &gt; 0 &amp;&amp; x &lt; width-1 &amp;&amp; y &gt; 0 &amp;&amp; y &lt; <a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>-1 ) {
<a name="l00612"></a>00612 
<a name="l00613"></a>00613         <span class="comment">// scan through a 8-connex neighborhood</span>
<a name="l00614"></a>00614         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dy = -1; dy &lt;= 1; dy++ ) {
<a name="l00615"></a>00615             <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dx = -1; dx &lt;= 1; dx++ ) {
<a name="l00616"></a>00616                 <span class="keywordflow">if</span>( !( dx == 0 &amp;&amp; dy == 0 ) ) {
<a name="l00617"></a>00617 
<a name="l00618"></a>00618                     <span class="comment">// if ∃ a neighbor ∈ Lout | ∈ Rout</span>
<a name="l00619"></a>00619                     <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[ (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> ] &gt;= 0 ) {
<a name="l00620"></a>00620                         <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// is not redundant point of Lin</span>
<a name="l00621"></a>00621                     }
<a name="l00622"></a>00622 
<a name="l00623"></a>00623                 }
<a name="l00624"></a>00624             }
<a name="l00625"></a>00625         }
<a name="l00626"></a>00626 
<a name="l00627"></a>00627     }
<a name="l00628"></a>00628 
<a name="l00629"></a>00629     <span class="comment">// if in the border of the image, tests of neighbors</span>
<a name="l00630"></a>00630     <span class="keywordflow">else</span> {
<a name="l00631"></a>00631 
<a name="l00632"></a>00632         <span class="comment">// scan through a 8-connex neighborhood</span>
<a name="l00633"></a>00633         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dy = -1; dy &lt;= 1; dy++ ) {
<a name="l00634"></a>00634             <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dx = -1; dx &lt;= 1; dx++ ) {
<a name="l00635"></a>00635                 <span class="keywordflow">if</span>( !( dx == 0 &amp;&amp; dy == 0 ) ) {
<a name="l00636"></a>00636 
<a name="l00637"></a>00637                     <span class="comment">// neighbors tests</span>
<a name="l00638"></a>00638                     <span class="keywordflow">if</span>( x+dx &gt;= 0 &amp;&amp; x+dx &lt; width &amp;&amp; y+dy &gt;= 0 &amp;&amp; y+dy &lt; <a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a> ) {
<a name="l00639"></a>00639 
<a name="l00640"></a>00640                         <span class="comment">// if ∃ a neighbor ∈ Lout | ∈ Rout</span>
<a name="l00641"></a>00641                         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[ (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> ] &gt;= 0 ) {
<a name="l00642"></a>00642                             <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// is not redundant point of Lin</span>
<a name="l00643"></a>00643                         }
<a name="l00644"></a>00644 
<a name="l00645"></a>00645                     }
<a name="l00646"></a>00646 
<a name="l00647"></a>00647                 }
<a name="l00648"></a>00648             }
<a name="l00649"></a>00649         }
<a name="l00650"></a>00650 
<a name="l00651"></a>00651     }
<a name="l00652"></a>00652 
<a name="l00653"></a>00653     <span class="comment">// ==&gt; ∀ neighbors ∈ Lin | ∈ Rin</span>
<a name="l00654"></a>00654     <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// is redundant point of Lin</span>
<a name="l00655"></a>00655 }
<a name="l00656"></a>00656 
<a name="l00657"></a><a class="code" href="classofeli_1_1_active_contour.html#a4ae66c32025302590ea82814909f8020">00657</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classofeli_1_1_active_contour.html#a4ae66c32025302590ea82814909f8020" title="To find if a current point (x,y) of Lout is redundant.">ActiveContour::find_isRedundantPointOfLout</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y)<span class="keyword"> const </span>{
<a name="l00658"></a>00658 
<a name="l00659"></a>00659     <span class="comment">// if not in the border of the image, no neighbor test</span>
<a name="l00660"></a>00660     <span class="keywordflow">if</span>( x &gt; 0 &amp;&amp; x &lt; width-1 &amp;&amp; y &gt; 0 &amp;&amp; y &lt; <a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a>-1 ) {
<a name="l00661"></a>00661 
<a name="l00662"></a>00662         <span class="comment">// scan through a 8-connex neighborhood</span>
<a name="l00663"></a>00663         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dy = -1; dy &lt;= 1; dy++ ) {
<a name="l00664"></a>00664             <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dx = -1; dx &lt;= 1; dx++ ) {
<a name="l00665"></a>00665                 <span class="keywordflow">if</span>( !( dx == 0 &amp;&amp; dy == 0 ) ) {
<a name="l00666"></a>00666 
<a name="l00667"></a>00667                     <span class="comment">// if ∃ a neighbor ∈ Lin | ∈ Rin</span>
<a name="l00668"></a>00668                     <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[ (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> ] &lt;= 0 ) {
<a name="l00669"></a>00669                         <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// is not redundant point of Lout</span>
<a name="l00670"></a>00670                     }
<a name="l00671"></a>00671 
<a name="l00672"></a>00672                 }
<a name="l00673"></a>00673             }
<a name="l00674"></a>00674         }
<a name="l00675"></a>00675 
<a name="l00676"></a>00676     }
<a name="l00677"></a>00677 
<a name="l00678"></a>00678     <span class="comment">// if in the border of the image, tests of neighbors</span>
<a name="l00679"></a>00679     <span class="keywordflow">else</span> {
<a name="l00680"></a>00680 
<a name="l00681"></a>00681         <span class="comment">// scan through a 8-connex neighborhood</span>
<a name="l00682"></a>00682         <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dy = -1; dy &lt;= 1; dy++ ) {
<a name="l00683"></a>00683             <span class="keywordflow">for</span>( <span class="keywordtype">int</span> dx = -1; dx &lt;= 1; dx++ ) {
<a name="l00684"></a>00684                 <span class="keywordflow">if</span>( !( dx == 0 &amp;&amp; dy == 0 ) ) {
<a name="l00685"></a>00685 
<a name="l00686"></a>00686                     <span class="comment">// neighbors tests</span>
<a name="l00687"></a>00687                     <span class="keywordflow">if</span>( x+dx &gt;= 0 &amp;&amp; x+dx &lt; width &amp;&amp; y+dy &gt;= 0 &amp;&amp; y+dy &lt; <a class="code" href="classofeli_1_1_active_contour.html#ae5afc22b4d861c8c0d01f7ce45f60f08" title="Image height, i.e. number of rows.">height</a> ) {
<a name="l00688"></a>00688 
<a name="l00689"></a>00689                         <span class="comment">// if ∃ a neighbor ∈ Lin | ∈ Rin</span>
<a name="l00690"></a>00690                         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[ (x+dx)+(y+dy)*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a> ] &lt;= 0 ) {
<a name="l00691"></a>00691                             <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// is not redundant point of Lout</span>
<a name="l00692"></a>00692                         }
<a name="l00693"></a>00693 
<a name="l00694"></a>00694                     }
<a name="l00695"></a>00695 
<a name="l00696"></a>00696                 }
<a name="l00697"></a>00697             }
<a name="l00698"></a>00698         }
<a name="l00699"></a>00699 
<a name="l00700"></a>00700     }
<a name="l00701"></a>00701 
<a name="l00702"></a>00702     <span class="comment">// ==&gt; ∀ neighbors ∈ Lout | ∈ Rout</span>
<a name="l00703"></a>00703     <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// is redundant point of Lout</span>
<a name="l00704"></a>00704 }
<a name="l00705"></a>00705 
<a name="l00706"></a><a class="code" href="classofeli_1_1_active_contour.html#a2fbcb81cc03239dae86e7a235dd64e00">00706</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a2fbcb81cc03239dae86e7a235dd64e00" title="To eliminate redundant points in Lin.">ActiveContour::eliminate_redundant_in_Lin</a>() {
<a name="l00707"></a>00707 
<a name="l00708"></a>00708     <span class="keywordtype">int</span> i; <span class="comment">// offset of phi</span>
<a name="l00709"></a>00709 
<a name="l00710"></a>00710     <span class="keywordtype">int</span> x, y; <span class="comment">// position of the current pixel</span>
<a name="l00711"></a>00711 
<a name="l00712"></a>00712     <span class="comment">// scan through Lin</span>
<a name="l00713"></a>00713     <span class="keywordflow">for</span>( <a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a> = <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>.begin(); <a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a> != <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>.end();  ) {
<a name="l00714"></a>00714 
<a name="l00715"></a>00715         i = *<a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a>;
<a name="l00716"></a>00716 
<a name="l00717"></a>00717         <span class="comment">// i = x+y*width so</span>
<a name="l00718"></a>00718         y = i/<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00719"></a>00719         x = i-y*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00720"></a>00720 
<a name="l00721"></a>00721         <span class="comment">// if ∀ neighbors ∈ Lin | ∈ Rin</span>
<a name="l00722"></a>00722         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#aa48c1dcf4663b546403254294b481c12" title="To find if a current point (x,y) of Lin is redundant.">find_isRedundantPointOfLin</a>(x,y) ) {
<a name="l00723"></a>00723 
<a name="l00724"></a>00724             <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[i] = -3; <span class="comment">// phi(point) = -1 --&gt; -3</span>
<a name="l00725"></a>00725             <a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a> = <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>.erase(<a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a>); <span class="comment">// point ∈ Lin --&gt; ∈ Rin</span>
<a name="l00726"></a>00726 
<a name="l00727"></a>00727         }
<a name="l00728"></a>00728         <span class="keywordflow">else</span> {
<a name="l00729"></a>00729             ++<a class="code" href="classofeli_1_1_active_contour.html#a649f372adb78019bce4b4820c864c2c2" title="Iterator to move inside the linked list Lin.">itera_in</a>;
<a name="l00730"></a>00730         }
<a name="l00731"></a>00731 
<a name="l00732"></a>00732     }
<a name="l00733"></a>00733 
<a name="l00734"></a>00734     <span class="keywordflow">return</span>;
<a name="l00735"></a>00735 }
<a name="l00736"></a>00736 
<a name="l00737"></a><a class="code" href="classofeli_1_1_active_contour.html#a33de623e3a4aefe9f31b6ec28428f807">00737</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a33de623e3a4aefe9f31b6ec28428f807" title="To eliminate redundant points in Lout.">ActiveContour::eliminate_redundant_in_Lout</a>() {
<a name="l00738"></a>00738 
<a name="l00739"></a>00739     <span class="keywordtype">int</span> i; <span class="comment">// offset of phi</span>
<a name="l00740"></a>00740 
<a name="l00741"></a>00741     <span class="keywordtype">int</span> x, y; <span class="comment">// position of the current pixel</span>
<a name="l00742"></a>00742 
<a name="l00743"></a>00743     <span class="comment">// scan through Lout</span>
<a name="l00744"></a>00744     <span class="keywordflow">for</span>( <a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a> = <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>.begin(); <a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a> != <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>.end();  ) {
<a name="l00745"></a>00745 
<a name="l00746"></a>00746         i = *<a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a>;
<a name="l00747"></a>00747 
<a name="l00748"></a>00748         <span class="comment">// i=x+y*width so</span>
<a name="l00749"></a>00749         y = i/<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00750"></a>00750         x = i-y*<a class="code" href="classofeli_1_1_active_contour.html#ae54cb362f5c1c796b3ef9916a11d29f7" title="Image width, i.e. number of columns.">width</a>;
<a name="l00751"></a>00751 
<a name="l00752"></a>00752         <span class="comment">// if ∀ neighbors ∈ Lout | ∈ Rout</span>
<a name="l00753"></a>00753         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a4ae66c32025302590ea82814909f8020" title="To find if a current point (x,y) of Lout is redundant.">find_isRedundantPointOfLout</a>(x,y) ) {
<a name="l00754"></a>00754 
<a name="l00755"></a>00755             <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>[i] = 3; <span class="comment">// phi(point) = 1 --&gt; 3</span>
<a name="l00756"></a>00756             <a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a> = <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>.erase(<a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a>); <span class="comment">// point ∈ Lout --&gt; ∈ Rout</span>
<a name="l00757"></a>00757 
<a name="l00758"></a>00758         }
<a name="l00759"></a>00759         <span class="keywordflow">else</span> {
<a name="l00760"></a>00760             ++<a class="code" href="classofeli_1_1_active_contour.html#a444bd588f68707f0456c9fccf1fe18e0" title="Iterator to move inside the linked list Lout.">itera_out</a>;
<a name="l00761"></a>00761         }
<a name="l00762"></a>00762     }
<a name="l00763"></a>00763 
<a name="l00764"></a>00764     <span class="keywordflow">return</span>;
<a name="l00765"></a>00765 }
<a name="l00766"></a>00766 
<a name="l00767"></a>00767 
<a name="l00768"></a><a class="code" href="classofeli_1_1_active_contour.html#ab53eb16e33ba58b3bb9402a186d71d31">00768</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classofeli_1_1_active_contour.html#ab53eb16e33ba58b3bb9402a186d71d31" title="To compute the external speed Fd for a current point (x,y) of Lout or Lin.">ActiveContour::compute_external_speed_Fd</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
<a name="l00769"></a>00769 
<a name="l00770"></a>00770     <span class="comment">// this class should never be instantiated</span>
<a name="l00771"></a>00771 
<a name="l00772"></a>00772     <span class="keywordflow">return</span> -1; <span class="comment">// always an inward movement of the active contour, not a very discriminant speed...</span>
<a name="l00773"></a>00773 
<a name="l00774"></a>00774     <span class="comment">// reimplement a better and data-dependant function in a child class</span>
<a name="l00775"></a>00775 }
<a name="l00776"></a>00776 
<a name="l00777"></a>00777 <span class="comment">// at the end of each iteration in the cycle 1</span>
<a name="l00778"></a><a class="code" href="classofeli_1_1_active_contour.html#a7c7275006d98705cd7f04f8a7fe7e697">00778</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a7c7275006d98705cd7f04f8a7fe7e697" title="First stopping condition called at the end of each iteration of the cycle 1. Update of hasListsChange...">ActiveContour::calculate_stopping_conditions1</a>() {
<a name="l00779"></a>00779 
<a name="l00780"></a>00780     <span class="keywordflow">if</span>( !<a class="code" href="classofeli_1_1_active_contour.html#af437460aa2cdf312166a3fe4d54beeb4" title="Boolean egals to true if one point of Lin at least is switched out during the scan throw the Lin list...">hasInwardEvolution</a> &amp;&amp; !<a class="code" href="classofeli_1_1_active_contour.html#a9dcea2f4d6803007fe98e38152adf000" title="Boolean egals to true if one point of Lout at least is switched in during the scan throw the Lout lis...">hasOutwardEvolution</a> ) {
<a name="l00781"></a>00781         <a class="code" href="classofeli_1_1_active_contour.html#acaaac3e08e34cf03c1320c220b188b78" title="Boolean egals to true if hasOutwardEvolution egals to true or hasInwardEvolution egals to true...">hasListsChanges</a> = <span class="keyword">false</span>;
<a name="l00782"></a>00782     }
<a name="l00783"></a>00783 
<a name="l00784"></a>00784     <a class="code" href="classofeli_1_1_active_contour.html#ac155630f750a4811ddbcb5c3b0aff2df" title="Number of times the active contour evolves.">iterations</a>++;
<a name="l00785"></a>00785 
<a name="l00786"></a>00786     <span class="keywordflow">if</span>( !<a class="code" href="classofeli_1_1_active_contour.html#acaaac3e08e34cf03c1320c220b188b78" title="Boolean egals to true if hasOutwardEvolution egals to true or hasInwardEvolution egals to true...">hasListsChanges</a> || <a class="code" href="classofeli_1_1_active_contour.html#ac155630f750a4811ddbcb5c3b0aff2df" title="Number of times the active contour evolves.">iterations</a> &gt;= <a class="code" href="classofeli_1_1_active_contour.html#af703d4f53719f3a8bebb14f70c43c037" title="Maximum number of times the active contour can evolve.">max_iterations</a> ) {
<a name="l00787"></a>00787 
<a name="l00788"></a>00788         <a class="code" href="classofeli_1_1_active_contour.html#a2ff3ef2151ddf1e7f9f260ad9bf3d6f2" title="Boolean egals to false to go away the cycle 1 and never to go back into.">hasCycle1</a>=<span class="keyword">false</span>;
<a name="l00789"></a>00789 
<a name="l00790"></a>00790         <span class="keywordflow">if</span>( !<a class="code" href="classofeli_1_1_active_contour.html#a2d78fdef72930323ab6bdd38b167afa1" title="Boolean egals to true to have the curve smoothing, evolutions in the cycle 2 with the internal speed ...">hasSmoothingCycle</a> ) {
<a name="l00791"></a>00791             <a class="code" href="classofeli_1_1_active_contour.html#ac239b94976782c0769bda5d2b1e3d1b8" title="Boolean egals to true to stop the algorithm.">hasAlgoStopping</a> = <span class="keyword">true</span>;
<a name="l00792"></a>00792         }
<a name="l00793"></a>00793     }
<a name="l00794"></a>00794 
<a name="l00795"></a>00795     <span class="keywordflow">return</span>;
<a name="l00796"></a>00796 }
<a name="l00797"></a>00797 
<a name="l00798"></a>00798 <span class="comment">// at the end of the last iteration of the cycle 2</span>
<a name="l00799"></a><a class="code" href="classofeli_1_1_active_contour.html#a218109b08dd520c95ee7613235bb0593">00799</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a218109b08dd520c95ee7613235bb0593" title="Second stopping condition called at the end of the cycle 2. Update of hasOscillation. Two tests on hasOscillation and iterations are done. If one test is positive, hasAlgoStopping egals to true and the active contour stops.">ActiveContour::calculate_stopping_conditions2</a>() {
<a name="l00800"></a>00800 
<a name="l00801"></a>00801     <span class="comment">// if the relative difference of active contour length between two cycle2 is less of 0.01</span>
<a name="l00802"></a>00802     <span class="keywordflow">if</span>( <span class="keywordtype">double</span>(<a class="code" href="classofeli_1_1_active_contour.html#ac0308758e9f0ed52a86a346be3cd36be" title="To give the absolute value of an input value.">give_absolute_value</a>(<a class="code" href="classofeli_1_1_active_contour.html#a653c2bcd37ed61e9eacda89a013590d4" title="Length of Lin + length of Lout of the previous iteration.">previous_lists_length</a>-<a class="code" href="classofeli_1_1_active_contour.html#aefe0738d8a43f3981d591a0cc78ed717" title="Length of Lin + length of Lout.">lists_length</a>))/<span class="keywordtype">double</span>(<a class="code" href="classofeli_1_1_active_contour.html#aa90457ecf4d1eda42f605b109c53466c" title="To give the maximum of 2 values.">give_maximum_value</a>(<a class="code" href="classofeli_1_1_active_contour.html#aefe0738d8a43f3981d591a0cc78ed717" title="Length of Lin + length of Lout.">lists_length</a>,<a class="code" href="classofeli_1_1_active_contour.html#a653c2bcd37ed61e9eacda89a013590d4" title="Length of Lin + length of Lout of the previous iteration.">previous_lists_length</a>)) &lt; 0.01 ) {
<a name="l00803"></a>00803         <a class="code" href="classofeli_1_1_active_contour.html#a2ed4a3e2aa6904c287412a1510318b96" title="To count the number of times the relative gap of the lists length are less of a constant, fixed at 0.5%.">counter</a>++;
<a name="l00804"></a>00804     }
<a name="l00805"></a>00805     <span class="comment">// not consecutivly ==&gt; reinitialization</span>
<a name="l00806"></a>00806     <span class="keywordflow">else</span> {
<a name="l00807"></a>00807         <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a2ed4a3e2aa6904c287412a1510318b96" title="To count the number of times the relative gap of the lists length are less of a constant, fixed at 0.5%.">counter</a> != 0 ) {
<a name="l00808"></a>00808             <a class="code" href="classofeli_1_1_active_contour.html#a2ed4a3e2aa6904c287412a1510318b96" title="To count the number of times the relative gap of the lists length are less of a constant, fixed at 0.5%.">counter</a> = 0;
<a name="l00809"></a>00809         }
<a name="l00810"></a>00810     }
<a name="l00811"></a>00811 
<a name="l00812"></a>00812     <span class="comment">// if 3 times consecutivly</span>
<a name="l00813"></a>00813     <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a2ed4a3e2aa6904c287412a1510318b96" title="To count the number of times the relative gap of the lists length are less of a constant, fixed at 0.5%.">counter</a> == 3 ) {
<a name="l00814"></a>00814         <a class="code" href="classofeli_1_1_active_contour.html#a23e817e4d98cdc2ba8da0b44c5d0ffb8" title="Boolean egals to true if oscillations are detected. In this case, hasAlgoStopping egals to true...">hasOscillation</a> = <span class="keyword">true</span>;
<a name="l00815"></a>00815     }
<a name="l00816"></a>00816 
<a name="l00817"></a>00817     <span class="keywordflow">if</span>( <a class="code" href="classofeli_1_1_active_contour.html#a23e817e4d98cdc2ba8da0b44c5d0ffb8" title="Boolean egals to true if oscillations are detected. In this case, hasAlgoStopping egals to true...">hasOscillation</a> || <a class="code" href="classofeli_1_1_active_contour.html#ac155630f750a4811ddbcb5c3b0aff2df" title="Number of times the active contour evolves.">iterations</a> &gt;= <a class="code" href="classofeli_1_1_active_contour.html#af703d4f53719f3a8bebb14f70c43c037" title="Maximum number of times the active contour can evolve.">max_iterations</a> || !<a class="code" href="classofeli_1_1_active_contour.html#a2ff3ef2151ddf1e7f9f260ad9bf3d6f2" title="Boolean egals to false to go away the cycle 1 and never to go back into.">hasCycle1</a> ) {
<a name="l00818"></a>00818         <a class="code" href="classofeli_1_1_active_contour.html#ac239b94976782c0769bda5d2b1e3d1b8" title="Boolean egals to true to stop the algorithm.">hasAlgoStopping</a> = <span class="keyword">true</span>;
<a name="l00819"></a>00819     }
<a name="l00820"></a>00820 
<a name="l00821"></a>00821     <span class="comment">// keep last length to compare after</span>
<a name="l00822"></a>00822     <a class="code" href="classofeli_1_1_active_contour.html#a653c2bcd37ed61e9eacda89a013590d4" title="Length of Lin + length of Lout of the previous iteration.">previous_lists_length</a> = <a class="code" href="classofeli_1_1_active_contour.html#aefe0738d8a43f3981d591a0cc78ed717" title="Length of Lin + length of Lout.">lists_length</a>;
<a name="l00823"></a>00823 
<a name="l00824"></a>00824     <span class="comment">// reinitialization</span>
<a name="l00825"></a>00825     <a class="code" href="classofeli_1_1_active_contour.html#aefe0738d8a43f3981d591a0cc78ed717" title="Length of Lin + length of Lout.">lists_length</a> = 0;
<a name="l00826"></a>00826 
<a name="l00827"></a>00827     <span class="keywordflow">return</span>;
<a name="l00828"></a>00828 }
<a name="l00829"></a>00829 
<a name="l00830"></a>00830 <span class="comment">// 3 static functions</span>
<a name="l00831"></a><a class="code" href="classofeli_1_1_active_contour.html#ac0308758e9f0ed52a86a346be3cd36be">00831</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classofeli_1_1_active_contour.html#ac0308758e9f0ed52a86a346be3cd36be" title="To give the absolute value of an input value.">ActiveContour::give_absolute_value</a>(<span class="keywordtype">int</span> value) {
<a name="l00832"></a>00832     <span class="keywordflow">if</span>( value &lt; 0 ) {
<a name="l00833"></a>00833         <span class="keywordflow">return</span> -value;
<a name="l00834"></a>00834     }
<a name="l00835"></a>00835     <span class="keywordflow">else</span> {
<a name="l00836"></a>00836         <span class="keywordflow">return</span> value;
<a name="l00837"></a>00837     }
<a name="l00838"></a>00838 }
<a name="l00839"></a>00839 
<a name="l00840"></a><a class="code" href="classofeli_1_1_active_contour.html#aa90457ecf4d1eda42f605b109c53466c">00840</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classofeli_1_1_active_contour.html#aa90457ecf4d1eda42f605b109c53466c" title="To give the maximum of 2 values.">ActiveContour::give_maximum_value</a>(<span class="keywordtype">int</span> value1, <span class="keywordtype">int</span> value2) {
<a name="l00841"></a>00841     <span class="keywordflow">if</span>( value1 &gt; value2 ) {
<a name="l00842"></a>00842         <span class="keywordflow">return</span> value1;
<a name="l00843"></a>00843     }
<a name="l00844"></a>00844     <span class="keywordflow">else</span> {
<a name="l00845"></a>00845         <span class="keywordflow">return</span> value2;
<a name="l00846"></a>00846     }
<a name="l00847"></a>00847 }
<a name="l00848"></a>00848 
<a name="l00849"></a><a class="code" href="classofeli_1_1_active_contour.html#a956bc173e581bc01066a5c98b55b4d62">00849</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classofeli_1_1_active_contour.html#a956bc173e581bc01066a5c98b55b4d62" title="To calculate max_iterations.">ActiveContour::calculate_max_iterations</a>(<span class="keywordtype">int</span> width1, <span class="keywordtype">int</span> height1) {
<a name="l00850"></a>00850     <span class="keywordflow">if</span>( width1 &gt; height1 ) {
<a name="l00851"></a>00851         <span class="keywordflow">return</span> 5*height1;
<a name="l00852"></a>00852     }
<a name="l00853"></a>00853     <span class="keywordflow">else</span> {
<a name="l00854"></a>00854         <span class="keywordflow">return</span> 5*width1;
<a name="l00855"></a>00855     }
<a name="l00856"></a>00856 }
<a name="l00857"></a>00857 
<a name="l00858"></a>00858 <span class="comment">// 3 getters to see the result</span>
<a name="l00859"></a><a class="code" href="classofeli_1_1_active_contour.html#a2ca29aefe34c31b6c2072742728a0eb6">00859</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> <a class="code" href="classofeli_1_1_active_contour.html#a2ca29aefe34c31b6c2072742728a0eb6" title="Getter function for the pointer phi.">ActiveContour::get_phi</a>()<span class="keyword"> const </span>{
<a name="l00860"></a>00860     <span class="keywordflow">return</span> <a class="code" href="classofeli_1_1_active_contour.html#aacb03a6ded4ca51cb52f58aeff955ef7" title="Pointer on the level-set function buffer.">phi</a>;
<a name="l00861"></a>00861 }
<a name="l00862"></a>00862 
<a name="l00863"></a><a class="code" href="classofeli_1_1_active_contour.html#ac8645d851c3b4dbed5fdb5b235214534">00863</a> <span class="keyword">const</span> std::list&lt;int&gt;&amp; <a class="code" href="classofeli_1_1_active_contour.html#ac8645d851c3b4dbed5fdb5b235214534" title="Getter function for the linked list Lout.">ActiveContour::get_Lout</a>()<span class="keyword"> const </span>{
<a name="l00864"></a>00864     <span class="keywordflow">return</span> <a class="code" href="classofeli_1_1_active_contour.html#ad372aecd98228c4277095dc84ac72656" title="Outside boundary list of points positions.">Lout</a>;
<a name="l00865"></a>00865 }
<a name="l00866"></a>00866 
<a name="l00867"></a><a class="code" href="classofeli_1_1_active_contour.html#a1934ff3c033461841f33784c85f3a0f4">00867</a> <span class="keyword">const</span> std::list&lt;int&gt;&amp; <a class="code" href="classofeli_1_1_active_contour.html#a1934ff3c033461841f33784c85f3a0f4" title="Getter function for the linked list Lin.">ActiveContour::get_Lin</a>()<span class="keyword"> const </span>{
<a name="l00868"></a>00868     <span class="keywordflow">return</span> <a class="code" href="classofeli_1_1_active_contour.html#afb7e254255029c150f5019de8a65b3cb" title="Inside boundary list of points positions.">Lin</a>;
<a name="l00869"></a>00869 }
<a name="l00870"></a>00870 
<a name="l00871"></a>00871 
<a name="l00872"></a>00872 
<a name="l00873"></a>00873 <span class="comment">// 5 getters to see the variables of the stopping conditions</span>
<a name="l00874"></a><a class="code" href="classofeli_1_1_active_contour.html#abdecbca7ff1f73b2b7ba52d19dfd56f3">00874</a> <span class="keywordtype">bool</span> <a class="code" href="classofeli_1_1_active_contour.html#abdecbca7ff1f73b2b7ba52d19dfd56f3" title="Getter function for the boolean hasListsChanges.">ActiveContour::get_hasListsChanges</a>()<span class="keyword"> const </span>{
<a name="l00875"></a>00875     <span class="keywordflow">return</span> <a class="code" href="classofeli_1_1_active_contour.html#acaaac3e08e34cf03c1320c220b188b78" title="Boolean egals to true if hasOutwardEvolution egals to true or hasInwardEvolution egals to true...">hasListsChanges</a>;
<a name="l00876"></a>00876 }
<a name="l00877"></a>00877 
<a name="l00878"></a><a class="code" href="classofeli_1_1_active_contour.html#a26b50306becb71e376fc9093f5732e7a">00878</a> <span class="keywordtype">bool</span> <a class="code" href="classofeli_1_1_active_contour.html#a26b50306becb71e376fc9093f5732e7a" title="Getter function for the boolean hasOscillation.">ActiveContour::get_hasOscillation</a>()<span class="keyword"> const </span>{
<a name="l00879"></a>00879     <span class="keywordflow">return</span> <a class="code" href="classofeli_1_1_active_contour.html#a23e817e4d98cdc2ba8da0b44c5d0ffb8" title="Boolean egals to true if oscillations are detected. In this case, hasAlgoStopping egals to true...">hasOscillation</a>;
<a name="l00880"></a>00880 }
<a name="l00881"></a>00881 
<a name="l00882"></a><a class="code" href="classofeli_1_1_active_contour.html#a934487d397d1d4609798b2ae6627100a">00882</a> <span class="keywordtype">int</span> <a class="code" href="classofeli_1_1_active_contour.html#a934487d397d1d4609798b2ae6627100a" title="Getter function for iterations.">ActiveContour::get_iterations</a>()<span class="keyword"> const </span>{
<a name="l00883"></a>00883     <span class="keywordflow">return</span> <a class="code" href="classofeli_1_1_active_contour.html#ac155630f750a4811ddbcb5c3b0aff2df" title="Number of times the active contour evolves.">iterations</a>;
<a name="l00884"></a>00884 }
<a name="l00885"></a>00885 
<a name="l00886"></a><a class="code" href="classofeli_1_1_active_contour.html#a08f7161a756743daeab8827b1fb3fe46">00886</a> <span class="keywordtype">int</span> <a class="code" href="classofeli_1_1_active_contour.html#a08f7161a756743daeab8827b1fb3fe46" title="Getter function for max_iterations.">ActiveContour::get_max_iterations</a>()<span class="keyword"> const </span>{
<a name="l00887"></a>00887     <span class="keywordflow">return</span> <a class="code" href="classofeli_1_1_active_contour.html#af703d4f53719f3a8bebb14f70c43c037" title="Maximum number of times the active contour can evolve.">max_iterations</a>;
<a name="l00888"></a>00888 }
<a name="l00889"></a>00889 
<a name="l00890"></a><a class="code" href="classofeli_1_1_active_contour.html#aabb77561db9271b00df81341f526e976">00890</a> <span class="keywordtype">bool</span> <a class="code" href="classofeli_1_1_active_contour.html#aabb77561db9271b00df81341f526e976" title="Getter function for the boolean hasAlgoStopping.">ActiveContour::get_hasAlgoStopping</a>()<span class="keyword"> const </span>{
<a name="l00891"></a>00891     <span class="keywordflow">return</span> <a class="code" href="classofeli_1_1_active_contour.html#ac239b94976782c0769bda5d2b1e3d1b8" title="Boolean egals to true to stop the algorithm.">hasAlgoStopping</a>;
<a name="l00892"></a>00892 }
<a name="l00893"></a>00893 
<a name="l00894"></a><a class="code" href="classofeli_1_1_active_contour.html#ad81d408bec3feae072028c7db664797d">00894</a> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#ad81d408bec3feae072028c7db664797d" title="Specific step reimplemented in the children active contours ACwithoutEdges and ACwithoutEdgesYUV to c...">ActiveContour::do_specific_beginning_step</a>() {
<a name="l00895"></a>00895     <span class="keywordflow">return</span>;
<a name="l00896"></a>00896 }
<a name="l00897"></a>00897 
<a name="l00898"></a><a class="code" href="classofeli_1_1_active_contour.html#ae34d798fec18971f9b0f6cbed59c090f">00898</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#ae34d798fec18971f9b0f6cbed59c090f" title="Specific step reimplemented in the children active contours ACwithoutEdges and ACwithoutEdgesYUV to u...">ActiveContour::do_specific_in_step</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
<a name="l00899"></a>00899     <span class="keywordflow">return</span>;
<a name="l00900"></a>00900 }
<a name="l00901"></a>00901 
<a name="l00902"></a><a class="code" href="classofeli_1_1_active_contour.html#ae938fd6dcb59480b9262c64094613984">00902</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#ae938fd6dcb59480b9262c64094613984" title="Specific step reimplemented in the children active contours ACwithoutEdges and ACwithoutEdgesYUV to u...">ActiveContour::do_specific_out_step</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
<a name="l00903"></a>00903     <span class="keywordflow">return</span>;
<a name="l00904"></a>00904 }
<a name="l00905"></a>00905 
<a name="l00906"></a><a class="code" href="classofeli_1_1_active_contour.html#a29ffb870edb974dc2ab0a1851e2483bf">00906</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a29ffb870edb974dc2ab0a1851e2483bf" title="Specific step reimplemented in the children active contours ACwithoutEdges and ACwithoutEdgesYUV to u...">ActiveContour::do_specific_in_step2</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
<a name="l00907"></a>00907     <span class="keywordflow">return</span>;
<a name="l00908"></a>00908 }
<a name="l00909"></a>00909 
<a name="l00910"></a>00910 
<a name="l00911"></a><a class="code" href="classofeli_1_1_active_contour.html#a265bec94de92dfa81d786099bcbc30ab">00911</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classofeli_1_1_active_contour.html#a265bec94de92dfa81d786099bcbc30ab" title="Specific step reimplemented in the children active contours ACwithoutEdges and ACwithoutEdgesYUV to u...">ActiveContour::do_specific_out_step2</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y) {
<a name="l00912"></a>00912     <span class="keywordflow">return</span>;
<a name="l00913"></a>00913 }
<a name="l00914"></a>00914 
<a name="l00915"></a>00915 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
